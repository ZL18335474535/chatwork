name: ci
on:
  pull_request:
  push:
    branches:
      - master
      - releases/*

jobs:
  build:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
      - uses: actions/checkout@v2
      - run: npm install
      - run: npm run all
    env:
      CHATWORK_ROOM_ID: ${{ secrets.CHATWORK_ROOM_ID }}
      CHATWORK_API_TOKEN: ${{ secrets.CHATWORK_API_TOKEN }}

  test:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
      - uses: actions/checkout@v2
      - uses: ./
        with:
          roomId: ${{ secrets.CHATWORK_ROOM_ID }}
          token: ${{ secrets.CHATWORK_API_TOKEN }}
          mapping: |
            {
              "mechiru": "chatwork/mechiru"
            }
          context: |
            {"action":"created","comment":{"author_association":"OWNER","body":"@mechiru fuga","created_at":"2020-10-08T07:55:44Z","html_url":"https://github.com/mechiru/try-github-actions/issues/6#issuecomment-705398997","id":705398997,"issue_url":"https://api.github.com/repos/mechiru/try-github-actions/issues/6","node_id":"MDEyOklzc3VlQ29tbWVudDcwNTM5ODk5Nw==","performed_via_github_app":null,"updated_at":"2020-10-08T07:55:44Z","url":"https://api.github.com/repos/mechiru/try-github-actions/issues/comments/705398997","user":{"avatar_url":"https://avatars0.githubusercontent.com/u/46036584?v=4","events_url":"https://api.github.com/users/mechiru/events{/privacy}","followers_url":"https://api.github.com/users/mechiru/followers","following_url":"https://api.github.com/users/mechiru/following{/other_user}","gists_url":"https://api.github.com/users/mechiru/gists{/gist_id}","gravatar_id":"","html_url":"https://github.com/mechiru","id":46036584,"login":"mechiru","node_id":"MDQ6VXNlcjQ2MDM2NTg0","organizations_url":"https://api.github.com/users/mechiru/orgs","received_events_url":"https://api.github.com/users/mechiru/received_events","repos_url":"https://api.github.com/users/mechiru/repos","site_admin":false,"starred_url":"https://api.github.com/users/mechiru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mechiru/subscriptions","type":"User","url":"https://api.github.com/users/mechiru"}},"issue":{"active_lock_reason":null,"assignee":{"avatar_url":"https://avatars0.githubusercontent.com/u/46036584?v=4","events_url":"https://api.github.com/users/mechiru/events{/privacy}","followers_url":"https://api.github.com/users/mechiru/followers","following_url":"https://api.github.com/users/mechiru/following{/other_user}","gists_url":"https://api.github.com/users/mechiru/gists{/gist_id}","gravatar_id":"","html_url":"https://github.com/mechiru","id":46036584,"login":"mechiru","node_id":"MDQ6VXNlcjQ2MDM2NTg0","organizations_url":"https://api.github.com/users/mechiru/orgs","received_events_url":"https://api.github.com/users/mechiru/received_events","repos_url":"https://api.github.com/users/mechiru/repos","site_admin":false,"starred_url":"https://api.github.com/users/mechiru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mechiru/subscriptions","type":"User","url":"https://api.github.com/users/mechiru"},"assignees":[{"avatar_url":"https://avatars0.githubusercontent.com/u/46036584?v=4","events_url":"https://api.github.com/users/mechiru/events{/privacy}","followers_url":"https://api.github.com/users/mechiru/followers","following_url":"https://api.github.com/users/mechiru/following{/other_user}","gists_url":"https://api.github.com/users/mechiru/gists{/gist_id}","gravatar_id":"","html_url":"https://github.com/mechiru","id":46036584,"login":"mechiru","node_id":"MDQ6VXNlcjQ2MDM2NTg0","organizations_url":"https://api.github.com/users/mechiru/orgs","received_events_url":"https://api.github.com/users/mechiru/received_events","repos_url":"https://api.github.com/users/mechiru/repos","site_admin":false,"starred_url":"https://api.github.com/users/mechiru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mechiru/subscriptions","type":"User","url":"https://api.github.com/users/mechiru"}],"author_association":"OWNER","body":"hoge\r\nfuga\r\n","closed_at":null,"comments":11,"comments_url":"https://api.github.com/repos/mechiru/try-github-actions/issues/6/comments","created_at":"2020-10-08T06:54:34Z","events_url":"https://api.github.com/repos/mechiru/try-github-actions/issues/6/events","html_url":"https://github.com/mechiru/try-github-actions/issues/6","id":717077243,"labels":[],"labels_url":"https://api.github.com/repos/mechiru/try-github-actions/issues/6/labels{/name}","locked":false,"milestone":null,"node_id":"MDU6SXNzdWU3MTcwNzcyNDM=","number":6,"performed_via_github_app":null,"repository_url":"https://api.github.com/repos/mechiru/try-github-actions","state":"open","title":"hoge","updated_at":"2020-10-08T07:55:44Z","url":"https://api.github.com/repos/mechiru/try-github-actions/issues/6","user":{"avatar_url":"https://avatars0.githubusercontent.com/u/46036584?v=4","events_url":"https://api.github.com/users/mechiru/events{/privacy}","followers_url":"https://api.github.com/users/mechiru/followers","following_url":"https://api.github.com/users/mechiru/following{/other_user}","gists_url":"https://api.github.com/users/mechiru/gists{/gist_id}","gravatar_id":"","html_url":"https://github.com/mechiru","id":46036584,"login":"mechiru","node_id":"MDQ6VXNlcjQ2MDM2NTg0","organizations_url":"https://api.github.com/users/mechiru/orgs","received_events_url":"https://api.github.com/users/mechiru/received_events","repos_url":"https://api.github.com/users/mechiru/repos","site_admin":false,"starred_url":"https://api.github.com/users/mechiru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mechiru/subscriptions","type":"User","url":"https://api.github.com/users/mechiru"}},"repository":{"archive_url":"https://api.github.com/repos/mechiru/try-github-actions/{archive_format}{/ref}","archived":false,"assignees_url":"https://api.github.com/repos/mechiru/try-github-actions/assignees{/user}","blobs_url":"https://api.github.com/repos/mechiru/try-github-actions/git/blobs{/sha}","branches_url":"https://api.github.com/repos/mechiru/try-github-actions/branches{/branch}","clone_url":"https://github.com/mechiru/try-github-actions.git","collaborators_url":"https://api.github.com/repos/mechiru/try-github-actions/collaborators{/collaborator}","comments_url":"https://api.github.com/repos/mechiru/try-github-actions/comments{/number}","commits_url":"https://api.github.com/repos/mechiru/try-github-actions/commits{/sha}","compare_url":"https://api.github.com/repos/mechiru/try-github-actions/compare/{base}...{head}","contents_url":"https://api.github.com/repos/mechiru/try-github-actions/contents/{+path}","contributors_url":"https://api.github.com/repos/mechiru/try-github-actions/contributors","created_at":"2020-10-07T14:34:33Z","default_branch":"master","deployments_url":"https://api.github.com/repos/mechiru/try-github-actions/deployments","description":null,"disabled":false,"downloads_url":"https://api.github.com/repos/mechiru/try-github-actions/downloads","events_url":"https://api.github.com/repos/mechiru/try-github-actions/events","fork":false,"forks":0,"forks_count":0,"forks_url":"https://api.github.com/repos/mechiru/try-github-actions/forks","full_name":"mechiru/try-github-actions","git_commits_url":"https://api.github.com/repos/mechiru/try-github-actions/git/commits{/sha}","git_refs_url":"https://api.github.com/repos/mechiru/try-github-actions/git/refs{/sha}","git_tags_url":"https://api.github.com/repos/mechiru/try-github-actions/git/tags{/sha}","git_url":"git://github.com/mechiru/try-github-actions.git","has_downloads":true,"has_issues":true,"has_pages":false,"has_projects":true,"has_wiki":true,"homepage":null,"hooks_url":"https://api.github.com/repos/mechiru/try-github-actions/hooks","html_url":"https://github.com/mechiru/try-github-actions","id":302064072,"issue_comment_url":"https://api.github.com/repos/mechiru/try-github-actions/issues/comments{/number}","issue_events_url":"https://api.github.com/repos/mechiru/try-github-actions/issues/events{/number}","issues_url":"https://api.github.com/repos/mechiru/try-github-actions/issues{/number}","keys_url":"https://api.github.com/repos/mechiru/try-github-actions/keys{/key_id}","labels_url":"https://api.github.com/repos/mechiru/try-github-actions/labels{/name}","language":"TypeScript","languages_url":"https://api.github.com/repos/mechiru/try-github-actions/languages","license":{"key":"mit","name":"MIT License","node_id":"MDc6TGljZW5zZTEz","spdx_id":"MIT","url":"https://api.github.com/licenses/mit"},"merges_url":"https://api.github.com/repos/mechiru/try-github-actions/merges","milestones_url":"https://api.github.com/repos/mechiru/try-github-actions/milestones{/number}","mirror_url":null,"name":"try-github-actions","node_id":"MDEwOlJlcG9zaXRvcnkzMDIwNjQwNzI=","notifications_url":"https://api.github.com/repos/mechiru/try-github-actions/notifications{?since,all,participating}","open_issues":6,"open_issues_count":6,"owner":{"avatar_url":"https://avatars0.githubusercontent.com/u/46036584?v=4","events_url":"https://api.github.com/users/mechiru/events{/privacy}","followers_url":"https://api.github.com/users/mechiru/followers","following_url":"https://api.github.com/users/mechiru/following{/other_user}","gists_url":"https://api.github.com/users/mechiru/gists{/gist_id}","gravatar_id":"","html_url":"https://github.com/mechiru","id":46036584,"login":"mechiru","node_id":"MDQ6VXNlcjQ2MDM2NTg0","organizations_url":"https://api.github.com/users/mechiru/orgs","received_events_url":"https://api.github.com/users/mechiru/received_events","repos_url":"https://api.github.com/users/mechiru/repos","site_admin":false,"starred_url":"https://api.github.com/users/mechiru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mechiru/subscriptions","type":"User","url":"https://api.github.com/users/mechiru"},"private":true,"pulls_url":"https://api.github.com/repos/mechiru/try-github-actions/pulls{/number}","pushed_at":"2020-10-08T07:55:20Z","releases_url":"https://api.github.com/repos/mechiru/try-github-actions/releases{/id}","size":657,"ssh_url":"git@github.com:mechiru/try-github-actions.git","stargazers_count":0,"stargazers_url":"https://api.github.com/repos/mechiru/try-github-actions/stargazers","statuses_url":"https://api.github.com/repos/mechiru/try-github-actions/statuses/{sha}","subscribers_url":"https://api.github.com/repos/mechiru/try-github-actions/subscribers","subscription_url":"https://api.github.com/repos/mechiru/try-github-actions/subscription","svn_url":"https://github.com/mechiru/try-github-actions","tags_url":"https://api.github.com/repos/mechiru/try-github-actions/tags","teams_url":"https://api.github.com/repos/mechiru/try-github-actions/teams","trees_url":"https://api.github.com/repos/mechiru/try-github-actions/git/trees{/sha}","updated_at":"2020-10-08T07:55:22Z","url":"https://api.github.com/repos/mechiru/try-github-actions","watchers":0,"watchers_count":0},"sender":{"avatar_url":"https://avatars0.githubusercontent.com/u/46036584?v=4","events_url":"https://api.github.com/users/mechiru/events{/privacy}","followers_url":"https://api.github.com/users/mechiru/followers","following_url":"https://api.github.com/users/mechiru/following{/other_user}","gists_url":"https://api.github.com/users/mechiru/gists{/gist_id}","gravatar_id":"","html_url":"https://github.com/mechiru","id":46036584,"login":"mechiru","node_id":"MDQ6VXNlcjQ2MDM2NTg0","organizations_url":"https://api.github.com/users/mechiru/orgs","received_events_url":"https://api.github.com/users/mechiru/received_events","repos_url":"https://api.github.com/users/mechiru/repos","site_admin":false,"starred_url":"https://api.github.com/users/mechiru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mechiru/subscriptions","type":"User","url":"https://api.github.com/users/mechiru"}}
